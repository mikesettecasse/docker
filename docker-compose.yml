version: '3.0'
services:
  web:
   image: nginx:latest
   ports:
    - "8080:80"
   volumes:
    - ./app:/app 
    - ./site.conf:/etc/nginx/conf.d/default.conf
   depends_on:
    - php

  php:
   build: 
    context: . 
    dockerfile: dockerfiles/Dockerfile
   volumes:
    - ./app:/app
   command: bash -c "/usr/local/bin/php_script.sh" 
   stdin_open: true
   ports:
    - "9000:9000"
   depends_on:
    - db

  db:
   image: mysql
   environment:
    - MYSQL_DATABASE=milken
    - MYSQL_USER=milkenDev
    - MYSQL_ROOT_PASSWORD=123
    - MYSQL_PASSWORD=123
   ports:
    - "33061:3306"  
   volumes:
    - ./db_data:/var/lib/mysql
   restart: always

